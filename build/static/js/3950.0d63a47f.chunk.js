"use strict";(self.webpackChunkreal_estate=self.webpackChunkreal_estate||[]).push([[3950],{3950:(e,a,t)=>{t.r(a),t.d(a,{default:()=>V});var n=t(65043),l=t(14034),s=t(19754),o=t(4450),i=t(85376),r=t(22554),d=t(66305),c=t(95574),u=t(88031),h=t(17368),m=t(73216),x=t(35475),g=t(63516),v=t(80899),j=t(40848),p=t(78510),S=t(67682),C=t(19488),f=t(86178),D=t.n(f),T=t(43017),y=t(97508),b=t(70579);const F=e=>{const{allData:a,advanceSearch:t,setAdvanceSearch:n,isLoding:l,setSearchedData:s,setDisplaySearchData:i,setSearchbox:d,setAction:c}=e,u=(0,y.wA)(),h=v.Ik({agenda:v.Yj(),location:v.Yj()}),m=(0,g.Wx)({initialValues:{agenda:"",location:"",fromDateTime:"",toDateTime:""},validationSchema:h,onSubmit:e=>{const t=a.filter((a=>{const t=!e.agenda||a.agenda.toLowerCase().includes(e.agenda.toLowerCase()),n=!e.location||a.location&&a.location.toLowerCase().includes(e.location.toLowerCase()),l=D()(a.dateTime),s=!e.fromDateTime||l.isSameOrAfter(D()(e.fromDateTime)),o=!e.toDateTime||l.isSameOrBefore(D()(e.toDateTime));return t&&n&&s&&o})),l=[];e.agenda&&l.push({name:["agenda"],value:"Agenda: ".concat(e.agenda)}),e.location&&l.push({name:["location"],value:"Location: ".concat(e.location)}),(e.fromDateTime||e.toDateTime)&&l.push({name:["fromDateTime","toDateTime"],value:"Date: ".concat(e.fromDateTime?D()(e.fromDateTime).format("MMM DD, YYYY"):"Any"," to ").concat(e.toDateTime?D()(e.toDateTime).format("MMM DD, YYYY"):"Any")}),u((0,T.Tr)(l)),u((0,T.DW)({values:e,allData:a,type:"Meeting"})),s(t),i(!0),n(!1),d("")}}),{errors:x,touched:f,values:F,handleBlur:L,handleChange:B,handleSubmit:I,setFieldValue:w,resetForm:A,dirty:Y}=m;return(0,b.jsxs)(j.aF,{onClose:()=>{n(!1),A()},isOpen:t,isCentered:!0,size:"xl",children:[(0,b.jsx)(j.mH,{}),(0,b.jsxs)(j.$m,{children:[(0,b.jsx)(j.rQ,{children:"Advanced Search"}),(0,b.jsx)(j.s_,{onClick:()=>{n(!1),A()}}),(0,b.jsx)(j.cw,{children:(0,b.jsx)(o.VStack,{spacing:4,children:(0,b.jsxs)(o.Grid,{templateColumns:"repeat(2, 1fr)",gap:4,width:"100%",children:[(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:"Agenda"}),(0,b.jsx)(S.Input,{name:"agenda",value:F.agenda,onChange:B,onBlur:L,placeholder:"Search by agenda..."})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:"Location"}),(0,b.jsx)(S.Input,{name:"location",value:F.location,onChange:B,onBlur:L,placeholder:"Search by location..."})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:"From Date"}),(0,b.jsx)(S.Input,{type:"datetime-local",name:"fromDateTime",value:F.fromDateTime,onChange:B,onBlur:L})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:"To Date"}),(0,b.jsx)(S.Input,{type:"datetime-local",name:"toDateTime",value:F.toDateTime,onChange:B,onBlur:L})]})})]})})}),(0,b.jsxs)(j.jl,{children:[(0,b.jsx)(r.Button,{size:"sm",variant:"brand",mr:2,onClick:I,disabled:!(!l&&Y),children:l?(0,b.jsx)(C.A,{}):"Search"}),(0,b.jsx)(r.Button,{size:"sm",variant:"outline",colorScheme:"red",onClick:()=>A(),children:"Clear"})]})]})]})};var L=t(89379),B=t(27039),I=t(84626),w=t(19154),A=t(53186);const Y=v.Ik({agenda:v.Yj().required("Agenda is required"),dateTime:v.Yj().required("Date and time is required"),location:v.Yj(),notes:v.Yj(),attendes:v.YO().of(v.Yj()),attendesLead:v.YO().of(v.Yj())}),_=e=>{let{contacts:a,leads:t,isOpen:l,onClose:s,selectedValues:i,onSuccess:c}=e;const[u,h]=(0,n.useState)(!1),[m,x]=(0,n.useState)(null),v=(0,B.dj)();(0,n.useEffect)((()=>{l&&(null!==i&&void 0!==i&&i[0]?(async e=>{try{var a,t,n;const l=(await(0,d.x4)("api/meeting/view/".concat(e))).data;x(l);const s=l.dateTime?D()(l.dateTime).format("YYYY-MM-DDTHH:mm"):"";C.setValues({agenda:l.agenda||"",dateTime:s,location:l.location||"",notes:l.notes||"",attendes:(null===(a=l.attendes)||void 0===a?void 0:a.map((e=>e._id)))||[],attendesLead:(null===(t=l.attendesLead)||void 0===t?void 0:t.map((e=>e._id)))||[],related:l.related||"",createBy:(null===(n=l.createBy)||void 0===n?void 0:n._id)||"",createFor:l.createFor||""})}catch(l){console.error("Error fetching meeting details:",l),v({title:"Error",description:"Failed to fetch meeting details",status:"error",duration:3e3,isClosable:!0})}})(i[0]):(x(null),C.resetForm()))}),[l,i]);const C=(0,g.Wx)({initialValues:{agenda:"",dateTime:"",location:"",notes:"",attendes:[],attendesLead:[],related:"",createBy:"",createFor:""},validationSchema:Y,onSubmit:async e=>{try{var a;h(!0);const t=(0,L.A)((0,L.A)({},e),{},{dateTime:D()(e.dateTime).toISOString(),createBy:e.createBy||(null===m||void 0===m||null===(a=m.createBy)||void 0===a?void 0:a._id)});m?(await(0,d.yP)("api/meeting/edit/".concat(m._id),t),v({title:"Success",description:"Meeting updated successfully",status:"success",duration:3e3,isClosable:!0})):(await(0,d.d_)("api/meeting/create",t),v({title:"Success",description:"Meeting created successfully",status:"success",duration:3e3,isClosable:!0})),c(),s()}catch(t){v({title:"Error",description:t.message||"Failed to ".concat(m?"update":"create"," meeting"),status:"error",duration:3e3,isClosable:!0})}finally{h(!1)}}});return(0,b.jsxs)(j.aF,{isOpen:l,onClose:s,size:"xl",children:[(0,b.jsx)(j.mH,{}),(0,b.jsx)(j.$m,{children:(0,b.jsxs)("form",{onSubmit:C.handleSubmit,children:[(0,b.jsx)(j.rQ,{children:m?"Edit Meeting":"Create Meeting"}),(0,b.jsx)(j.s_,{}),(0,b.jsx)(j.cw,{children:(0,b.jsx)(o.VStack,{spacing:4,children:(0,b.jsxs)(o.Grid,{templateColumns:"repeat(2, 1fr)",gap:4,width:"100%",children:[(0,b.jsx)(o.GridItem,{colSpan:2,children:(0,b.jsxs)(p.FormControl,{isRequired:!0,isInvalid:C.touched.agenda&&C.errors.agenda,children:[(0,b.jsx)(p.FormLabel,{children:"Agenda"}),(0,b.jsx)(S.Input,{name:"agenda",value:C.values.agenda,onChange:C.handleChange,onBlur:C.handleBlur,placeholder:"Enter meeting agenda"})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{isRequired:!0,isInvalid:C.touched.dateTime&&C.errors.dateTime,children:[(0,b.jsx)(p.FormLabel,{children:"Date & Time"}),(0,b.jsx)(S.Input,{type:"datetime-local",name:"dateTime",value:C.values.dateTime,onChange:C.handleChange,onBlur:C.handleBlur})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:"Location"}),(0,b.jsx)(S.Input,{name:"location",value:C.values.location,onChange:C.handleChange,onBlur:C.handleBlur,placeholder:"Enter meeting location"})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:"Related To"}),(0,b.jsx)(S.Input,{name:"related",value:C.values.related,onChange:C.handleChange,onBlur:C.handleBlur,placeholder:"Enter related information"})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:(null===a||void 0===a?void 0:a.length)>0?"Contact Attendees":"No contacts found"}),(0,b.jsx)(I.l6,{name:"attendes",value:"",onChange:e=>{const a=e.target.value;C.values.attendes.includes(a)||C.setFieldValue("attendes",[...C.values.attendes,a])},placeholder:"Select contacts",children:null===a||void 0===a?void 0:a.map((e=>(0,b.jsx)("option",{value:e._id,children:e.fullName},e._id)))}),(0,b.jsx)(o.Box,{mt:2,children:(0,b.jsx)(o.Wrap,{spacing:2,children:C.values.attendes.map((e=>{const t=null===a||void 0===a?void 0:a.find((a=>a._id===e));return t&&(0,b.jsx)(o.WrapItem,{children:(0,b.jsxs)(w.Tag,{size:"md",borderRadius:"full",variant:"solid",colorScheme:"blue",children:[(0,b.jsx)(w.TagLabel,{children:t.fullName}),(0,b.jsx)(w.TagCloseButton,{onClick:()=>(e=>{C.setFieldValue("attendes",C.values.attendes.filter((a=>a!==e)))})(e)})]})},e)}))})})]})}),(0,b.jsx)(o.GridItem,{children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:(null===t||void 0===t?void 0:t.length)>0?"Lead Attendees":"No leads found"}),(0,b.jsx)(I.l6,{name:"attendesLead",value:"",onChange:e=>{const a=e.target.value;C.values.attendesLead.includes(a)||C.setFieldValue("attendesLead",[...C.values.attendesLead,a])},placeholder:"Select leads",children:null===t||void 0===t?void 0:t.map((e=>(0,b.jsx)("option",{value:e._id,children:e.leadName},e._id)))}),(0,b.jsx)(o.Box,{mt:2,children:(0,b.jsx)(o.Wrap,{spacing:2,children:C.values.attendesLead.map((e=>{const a=null===t||void 0===t?void 0:t.find((a=>a._id===e));return a&&(0,b.jsx)(o.WrapItem,{children:(0,b.jsxs)(w.Tag,{size:"md",borderRadius:"full",variant:"solid",colorScheme:"green",children:[(0,b.jsx)(w.TagLabel,{children:a.leadName}),(0,b.jsx)(w.TagCloseButton,{onClick:()=>(e=>{C.setFieldValue("attendesLead",C.values.attendesLead.filter((a=>a!==e)))})(e)})]})},e)}))})})]})}),(0,b.jsx)(o.GridItem,{colSpan:2,children:(0,b.jsxs)(p.FormControl,{children:[(0,b.jsx)(p.FormLabel,{children:"Notes"}),(0,b.jsx)(A.T,{name:"notes",value:C.values.notes,onChange:C.handleChange,onBlur:C.handleBlur,rows:4,placeholder:"Enter meeting notes"})]})})]})})}),(0,b.jsxs)(j.jl,{children:[(0,b.jsx)(r.Button,{variant:"ghost",mr:3,onClick:s,children:"Cancel"}),(0,b.jsx)(r.Button,{colorScheme:"blue",type:"submit",isLoading:u,loadingText:m?"Updating...":"Creating...",children:m?"Update":"Create"})]})]})})]})};var O=t(48177),M=t(42145);const V=()=>{const e=(0,m.Zp)(),[a,t]=(0,n.useState)(!1),{isOpen:g,onOpen:v,onClose:j}=(0,s.j1)(),[p,S]=(0,n.useState)([]),[C,f]=(0,n.useState)(!1),[D,T]=(0,n.useState)([]),[y,L]=(0,n.useState)(""),[B,I]=(JSON.parse(localStorage.getItem("user")),(0,n.useState)(!1)),[w,A]=(0,n.useState)(!1),[Y,V]=(0,n.useState)([]),[k,E]=(0,n.useState)(!1),[G,z]=(0,n.useState)([]),[H]=(0,c.h)(["Meetings"]),[W,N]=(0,n.useState)([]),[R,q]=(0,n.useState)([]),U={Header:"Action",isSortable:!1,center:!0,cell:a=>{let{row:t}=a;return(0,b.jsx)(o.Text,{fontSize:"md",fontWeight:"900",textAlign:"center",children:(0,b.jsxs)(i.W1,{isLazy:!0,children:[(0,b.jsx)(i.IU,{children:(0,b.jsx)(h.txp,{})}),(0,b.jsxs)(i.cO,{minW:"fit-content",children:[(null===H||void 0===H?void 0:H.view)&&(0,b.jsx)(i.Dr,{py:2.5,color:"green",onClick:()=>e("/metting/".concat(null===t||void 0===t?void 0:t.values._id)),icon:(0,b.jsx)(l.ViewIcon,{fontSize:15}),children:"View"}),(null===H||void 0===H?void 0:H.update)&&(0,b.jsx)(i.Dr,{py:2.5,color:"blue",onClick:()=>{var e;S([null===t||void 0===t||null===(e=t.values)||void 0===e?void 0:e._id]),v()},icon:(0,b.jsx)(l.EditIcon,{fontSize:15}),children:"Edit"}),(null===H||void 0===H?void 0:H.delete)&&(0,b.jsx)(i.Dr,{py:2.5,color:"red",onClick:()=>{var e;I(!0),S([null===t||void 0===t||null===(e=t.values)||void 0===e?void 0:e._id])},icon:(0,b.jsx)(l.DeleteIcon,{fontSize:15}),children:"Delete"})]})]})})}},Q=[{Header:"#",accessor:"_id",isSortable:!1,width:10},{Header:"Agenda",accessor:"agenda",cell:e=>{var a;return(0,b.jsx)(x.N_,{to:"/metting/".concat(null===e||void 0===e||null===(a=e.row)||void 0===a?void 0:a.values._id),children:(0,b.jsx)(o.Text,{me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"}},color:"brand.600",fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e?void 0:e.value)||" - "})})}},{Header:"Date & Time",accessor:"dateTime"},{Header:"Location",accessor:"location"},{Header:"Attendees",accessor:"attendees",cell:e=>{var a,t;return(0,b.jsxs)(o.Text,{children:[((null===(a=e.row.original.attendes)||void 0===a?void 0:a.length)||0)+((null===(t=e.row.original.attendesLead)||void 0===t?void 0:t.length)||0)," ","Attendees"]})}},{Header:"Created By ",accessor:"createBy.firstName"},...null!==H&&void 0!==H&&H.update||null!==H&&void 0!==H&&H.view||null!==H&&void 0!==H&&H.delete?[U]:[]];return(0,n.useEffect)((()=>{(async()=>{A(!0);try{const e=await(0,d.x4)("api/meeting");V(e.data.meetings)}catch(e){M.oR.error(e.message||"Failed to fetch meetings")}A(!1)})()}),[a]),(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,d.x4)("api/contact");console.log("contacts"),console.log(e.data),N(e.data||[])}catch(e){console.error("Error fetching contacts:",e)}})(),(async()=>{try{const e=await(0,d.x4)("api/lead");console.log("leads"),console.log(e.data),q(e.data||[])}catch(e){console.error("Error fetching leads:",e)}})()}),[]),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.A,{title:"Meeting",isLoding:w,columnData:Q,allData:Y,tableData:Y,searchDisplay:k,setSearchDisplay:E,searchedDataOut:G,setSearchedDataOut:z,tableCustomFields:[],access:H,onOpen:v,selectedValues:p,setSelectedValues:S,setDelete:I,AdvanceSearch:(0,b.jsx)(r.Button,{variant:"outline",colorScheme:"brand",leftIcon:(0,b.jsx)(l.SearchIcon,{}),mt:{sm:"5px",md:"0"},size:"sm",onClick:()=>f(!0),children:"Advance Search"}),getTagValuesOutSide:D,searchboxOutside:y,setGetTagValuesOutside:T,setSearchboxOutside:L,handleSearchType:"MeetingSearch"}),(0,b.jsx)(F,{advanceSearch:C,setAdvanceSearch:f,setSearchedData:z,setDisplaySearchData:E,allData:Y,setAction:t,setGetTagValues:T,setSearchbox:L}),(0,b.jsx)(_,{contacts:W,leads:R,isOpen:g,onClose:()=>{j(),t((e=>!e))},onSuccess:()=>{t((e=>!e)),j()}}),(0,b.jsx)(O.A,{isOpen:B,onClose:()=>I(!1),type:"Meetings",handleDeleteData:async e=>{try{A(!0);200===(await(0,d.Vn)("api/meeting/deleteMany",e)).status&&(S([]),I(!1),t((e=>!e)),M.oR.success("Meetings deleted successfully"))}catch(a){M.oR.error(a.message||"Failed to delete meetings")}finally{A(!1)}},ids:p})]})}}}]);
//# sourceMappingURL=3950.0d63a47f.chunk.js.map