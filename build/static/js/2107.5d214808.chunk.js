"use strict";(self.webpackChunkreal_estate=self.webpackChunkreal_estate||[]).push([[2107],{2107:(e,l,t)=>{t.r(l),t.d(l,{default:()=>F});var i=t(65043),o=t(73216),s=t(95574),n=t(19754),a=t(4450),r=t(85376),d=t(14034),c=t(17368),u=t(66305),v=t(88031),p=t(68700),x=t(72943),h=t(40848),m=t(22554),j=t(19488),y=t(63516),f=t(23848),S=t(70579);const b=e=>{const{onClose:l,isOpen:t,fetchData:s,text:n,customFields:r}=e,[d,c]=(0,i.useState)(!1),u=(0,o.Zp)(),v=(0,y.Wx)({initialValues:{property:""},onSubmit:(e,l)=>{let{resetForm:t}=l;F(),t()}}),{errors:p,touched:x,values:b,handleBlur:g,handleChange:C,handleSubmit:A,setFieldValue:I,resetForm:z}=v,F=async()=>{try{c(!0),z(),b.property&&(l(),u("/propertyImport",{state:{fileData:b.property,customFields:r}}))}catch(e){console.log(e)}finally{c(!1)}};return(0,S.jsxs)(h.aF,{onClose:l,isOpen:t,isCentered:!0,children:[(0,S.jsx)(h.mH,{}),(0,S.jsxs)(h.$m,{children:[(0,S.jsx)(h.rQ,{children:"Import Properties"}),(0,S.jsx)(h.s_,{}),(0,S.jsx)(h.cw,{children:(0,S.jsx)(a.Grid,{templateColumns:"repeat(12, 1fr)",gap:3,children:(0,S.jsxs)(a.GridItem,{colSpan:{base:12},children:[(0,S.jsx)(f.A,{count:b.property.length,onFileSelect:e=>I("property",e),text:n}),(0,S.jsxs)(a.Text,{mb:"10px",color:"red",children:[" ",p.property&&x.property&&(0,S.jsxs)(S.Fragment,{children:["Please Select ",n]})]})]})})}),(0,S.jsxs)(h.jl,{children:[(0,S.jsx)(m.Button,{size:"sm",variant:"brand",onClick:A,disabled:!!d,children:d?(0,S.jsx)(j.A,{}):"Save"}),(0,S.jsx)(m.Button,{sx:{marginLeft:2,textTransform:"capitalize"},variant:"outline",colorScheme:"red",size:"sm",onClick:()=>{l(),v.resetForm()},children:"Close"})]})]})]})};var g=t(48177),C=t(33915),A=t(97508),I=t(53288),z=t(42145);const F=()=>{var e,l,t;JSON.parse(localStorage.getItem("user"));const h=(0,o.Zp)(),m=(0,A.wA)(),[j]=(0,s.h)(["Properties"]),[y,f]=(0,i.useState)(!1),[F,w]=(0,i.useState)([]),[D,O]=(0,i.useState)([]),[B,k]=(0,i.useState)(!1),{isOpen:V,onOpen:T,onClose:_}=(0,n.j1)(),[P,W]=(0,i.useState)([]),[E,G]=(0,i.useState)(!1),[H,U]=(0,i.useState)(!1),[L,N]=(0,i.useState)(),[R,J]=(0,i.useState)([]),[M,Q]=(0,i.useState)(!1),Z=(0,A.d4)((e=>{var l;return null===e||void 0===e||null===(l=e.propertyData)||void 0===l?void 0:l.data}));return(0,i.useEffect)((()=>{m((0,I.g)()),(async()=>{var e,l,t,i,o,s,n;f(!0);const u=await m((0,C.R)());var v;200===u.payload.status?W(null===u||void 0===u||null===(v=u.payload)||void 0===v?void 0:v.data):z.oR.error("Failed to fetch data","error");const p={Header:"Action",accessor:"action",isSortable:!1,center:!0,cell:e=>{let{row:l}=e;return(0,S.jsx)(a.Text,{fontSize:"md",fontWeight:"900",textAlign:"center",children:(0,S.jsxs)(r.W1,{isLazy:!0,children:[(0,S.jsx)(r.IU,{children:(0,S.jsx)(c.txp,{})}),(0,S.jsxs)(r.cO,{minW:"fit-content",transform:"translate(1520px, 173px);",children:[(null===j||void 0===j?void 0:j.update)&&(0,S.jsx)(r.Dr,{py:2.5,icon:(0,S.jsx)(d.EditIcon,{fontSize:15,mb:1}),onClick:()=>{var e;G(!0),N(null===l||void 0===l||null===(e=l.values)||void 0===e?void 0:e._id)},children:"Edit"}),(null===j||void 0===j?void 0:j.view)&&(0,S.jsx)(r.Dr,{py:2.5,color:"green",icon:(0,S.jsx)(d.ViewIcon,{mb:1,fontSize:15}),onClick:()=>{var e;h("/propertyView/".concat(null===l||void 0===l||null===(e=l.values)||void 0===e?void 0:e._id))},children:"View"}),(null===j||void 0===j?void 0:j.delete)&&(0,S.jsx)(r.Dr,{py:2.5,color:"red",icon:(0,S.jsx)(d.DeleteIcon,{fontSize:15,mb:1}),onClick:()=>{var e,t;U(!0),J([null===l||void 0===l||null===(e=l.values)||void 0===e?void 0:e._id]),N(null===l||void 0===l||null===(t=l.values)||void 0===t?void 0:t._id)},children:"Delete"})]})]})})}},x=[{Header:"#",accessor:"_id",isSortable:!1,width:10},...null!==u&&void 0!==u&&null!==(e=u.payload)&&void 0!==e&&e.data&&u.payload.data.length>0&&(null===(l=u.payload.data[0])||void 0===l||null===(t=l.fields)||void 0===t||null===(i=t.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField)&&(null===e||void 0===e?void 0:e.isView))))||void 0===i?void 0:i.map((e=>({Header:null===e||void 0===e?void 0:e.label,accessor:null===e||void 0===e?void 0:e.name,cell:e=>(0,S.jsx)("div",{className:"selectOpt",children:(0,S.jsx)(a.Text,{onClick:()=>{var l,t;h("/propertyView/".concat(null===e||void 0===e||null===(l=e.row)||void 0===l||null===(t=l.original)||void 0===t?void 0:t._id))},me:"10px",sx:{"&:hover":{color:"blue.500",textDecoration:"underline"},cursor:"pointer"},color:"brand.600",fontSize:"sm",fontWeight:"700",children:(null===e||void 0===e?void 0:e.value)||"-"})})}))))||[],...((null===u||void 0===u||null===(o=u.payload)||void 0===o||null===(s=o.data)||void 0===s||null===(n=s[0])||void 0===n?void 0:n.fields)||[]).filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField)&&!(null!==e&&void 0!==e&&e.isView))).map((e=>({Header:null===e||void 0===e?void 0:e.label,accessor:null===e||void 0===e?void 0:e.name}))),...null!==j&&void 0!==j&&j.update||null!==j&&void 0!==j&&j.view||null!==j&&void 0!==j&&j.delete?[p]:[]];O(x),f(!1)})()}),[B]),(0,S.jsxs)("div",{children:[(0,S.jsx)(a.Grid,{templateColumns:"repeat(6, 1fr)",mb:3,gap:4,children:!y&&(0,S.jsx)(a.GridItem,{colSpan:6,children:(0,S.jsx)(v.A,{title:"Properties",isLoding:y,columnData:null!==D&&void 0!==D?D:[],allData:null!==Z&&void 0!==Z?Z:[],tableData:Z,tableCustomFields:(null===P||void 0===P||null===(e=P[0])||void 0===e||null===(l=e.fields)||void 0===l?void 0:l.filter((e=>!0===(null===e||void 0===e?void 0:e.isTableField))))||[],access:j,onOpen:T,selectedValues:R,setSelectedValues:J,setDelete:U,setIsImport:Q})})}),V&&(0,S.jsx)(p.A,{propertyData:P[0],isOpen:V,size:"lg",onClose:_,setAction:k}),E&&(0,S.jsx)(x.A,{isOpen:E,size:"lg",propertyData:P[0],selectedId:L,setSelectedId:N,onClose:G,setAction:k}),H&&(0,S.jsx)(g.A,{isOpen:H,onClose:()=>U(!1),type:"Properties",handleDeleteData:async e=>{try{f(!0),200===(await(0,u.Vn)("api/property/deleteMany",e)).status&&(J([]),U(!1),k((e=>!e)))}catch(l){console.log(l)}finally{f(!1)}},ids:R}),M&&(0,S.jsx)(b,{text:"Property file",isOpen:M,onClose:Q,customFields:(null===P||void 0===P||null===(t=P[0])||void 0===t?void 0:t.fields)||[]})]})}},23848:(e,l,t)=>{t.d(l,{A:()=>d});var i=t(31206),o=t(4450),s=t(3458),n=t(71997),a=t(27149),r=t(70579);function d(e){const{count:l,text:t,onFileSelect:d}=e,c=(0,i.dU)("secondaryGray.900","white"),u=(0,i.dU)("brand.500","white");return(0,r.jsxs)(o.Grid,{templateColumns:"repeat(12, 1fr)",gap:2,children:[(0,r.jsx)(o.GridItem,{colSpan:{base:12},children:(0,r.jsx)(n.A,{w:{base:"100%"},me:"36px",minH:200,img:"Property Photos"===t?"img":"",csv:"csv",height:"100%",onFileSelect:d,isMultipleAllow:!1,content:(0,r.jsxs)(o.Box,{children:[(0,r.jsx)(s.In,{as:a.vpy,w:"80px",h:"80px",color:u}),(0,r.jsx)(o.Flex,{justify:"center",mx:"auto",mb:"12px",children:(0,r.jsx)(o.Text,{fontSize:"xl",fontWeight:"700",color:u,children:"Upload File"})}),l>0&&(0,r.jsxs)(o.Text,{fontSize:"sm",fontWeight:"500",color:"secondaryGray.500",children:["Selected Files : ",l]})]})})}),(0,r.jsx)(o.GridItem,{colSpan:{base:12},children:(0,r.jsxs)(o.Flex,{direction:"column",children:[(0,r.jsxs)(o.Text,{color:c,fontWeight:"bold",textAlign:"start",fontSize:"2xl",mt:{base:"20px"},children:["Upload ",t]}),(0,r.jsx)(o.Text,{color:"gray.400",fontSize:"md",my:{base:"auto"},mx:"auto",textAlign:"start",children:"Accepted File Type (csv, xlsx file - 15MB max) only 1 file"})]})})]})}},68700:(e,l,t)=>{t.d(l,{A:()=>h});var i=t(89379),o=t(14034),s=t(40848),n=t(22554),a=t(19488),r=t(63516),d=t(65043),c=t(66305),u=t(22030),v=t(48908),p=t(80899),x=t(70579);const h=e=>{var l,t;const[h,m]=(0,d.useState)(!1),j=Object.fromEntries(((null===e||void 0===e||null===(l=e.propertyData)||void 0===l?void 0:l.fields)||[]).map((e=>[null===e||void 0===e?void 0:e.name,""]))),y=(0,i.A)((0,i.A)({},j),{},{createBy:JSON.parse(localStorage.getItem("user"))._id}),f=(0,r.Wx)({initialValues:y,enableReinitialize:!0,validationSchema:p.Ik().shape((0,u.g)(null===e||void 0===e||null===(t=e.propertyData)||void 0===t?void 0:t.fields)),onSubmit:(e,l)=>{let{resetForm:t}=l;F()}}),{errors:S,touched:b,values:g,handleBlur:C,handleChange:A,handleSubmit:I,setFieldValue:z}=f,F=async()=>{try{var l;m(!0),200===(await(0,c.d_)("api/form/add",(0,i.A)((0,i.A)({},g),{},{moduleId:null===e||void 0===e||null===(l=e.propertyData)||void 0===l?void 0:l._id}))).status&&(e.onClose(),f.resetForm(),e.setAction((e=>!e)))}catch(t){console.log(t)}finally{m(!1)}};return(0,x.jsx)("div",{children:(0,x.jsxs)(s._s,{isOpen:e.isOpen,size:e.size,children:[(0,x.jsx)(s.QP,{}),(0,x.jsxs)(s.zj,{children:[(0,x.jsxs)(s.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Add Property",(0,x.jsx)(n.IconButton,{onClick:e.onClose,icon:(0,x.jsx)(o.CloseIcon,{})})]}),(0,x.jsx)(s.ys,{children:(0,x.jsx)(v.A,{moduleData:e.propertyData,values:g,setFieldValue:z,handleChange:A,handleBlur:C,errors:S,touched:b})}),(0,x.jsxs)(s.tb,{children:[(0,x.jsx)(n.Button,{size:"sm",sx:{textTransform:"capitalize"},disabled:!!h,variant:"brand",type:"submit",onClick:I,children:h?(0,x.jsx)(a.A,{}):"Save"}),(0,x.jsx)(n.Button,{size:"sm",variant:"outline",colorScheme:"red",sx:{marginLeft:2,textTransform:"capitalize"},onClick:e.onClose,children:"Close"})]})]})]})})}},72943:(e,l,t)=>{t.d(l,{A:()=>j});var i=t(89379),o=t(14034),s=t(40848),n=t(22554),a=t(4450),r=t(19488),d=t(63516),c=t(65043),u=t(73216),v=t(66305),p=t(22030),x=t(48908),h=t(80899),m=t(70579);const j=e=>{var l,t;const{data:j}=e,y=Object.fromEntries(((null===e||void 0===e||null===(l=e.leadData)||void 0===l?void 0:l.fields)||[]).map((e=>[null===e||void 0===e?void 0:e.name,""]))),[f,S]=(0,c.useState)((0,i.A)((0,i.A)({},y),{},{createBy:JSON.parse(localStorage.getItem("user"))._id})),b=(0,u.g)(),g=(0,d.Wx)({initialValues:f,validationSchema:h.Ik().shape((0,p.g)(null===e||void 0===e||null===(t=e.propertyData)||void 0===t?void 0:t.fields)),enableReinitialize:!0,onSubmit:(e,l)=>{let{resetForm:t}=l;k()}}),{errors:C,touched:A,values:I,handleBlur:z,handleChange:F,handleSubmit:w,setFieldValue:D}=g,[O,B]=(0,c.useState)(!1),k=async()=>{try{B(!0),200===(await(0,v.yP)("api/property/edit/".concat((null===e||void 0===e?void 0:e.selectedId)||b.id),I)).status&&(e.onClose(),e.setAction((e=>!e)))}catch(l){console.log(l)}finally{B(!1)}};let V;return(0,c.useEffect)((()=>{(async()=>{if(j)S((e=>(0,i.A)((0,i.A)({},e),j)));else if(null!==e&&void 0!==e&&e.selectedId)try{B(!0),V=await(0,v.x4)("api/property/view/",null===e||void 0===e?void 0:e.selectedId),S((e=>{var l,t;return(0,i.A)((0,i.A)({},e),null===(l=V)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.property)}))}catch(l){console.error(l)}finally{B(!1)}})()}),[null===e||void 0===e?void 0:e.selectedId,j]),(0,m.jsx)("div",{children:(0,m.jsxs)(s._s,{isOpen:e.isOpen,size:e.size,children:[(0,m.jsx)(s.QP,{}),(0,m.jsxs)(s.zj,{children:[(0,m.jsxs)(s.BE,{alignItems:"center",justifyContent:"space-between",display:"flex",children:["Edit Property",(0,m.jsx)(n.IconButton,{onClick:()=>{e.onClose(!1),e.setSelectedId&&(null===e||void 0===e||e.setSelectedId())},icon:(0,m.jsx)(o.CloseIcon,{})})]}),(0,m.jsx)(s.ys,{children:O?(0,m.jsx)(a.Flex,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,m.jsx)(r.A,{})}):(0,m.jsx)(x.A,{moduleData:e.propertyData,values:I,setFieldValue:D,handleChange:F,handleBlur:z,errors:C,touched:A})}),(0,m.jsxs)(s.tb,{children:[(0,m.jsx)(n.Button,{size:"sm",sx:{textTransform:"capitalize"},variant:"brand",disabled:!!O,type:"submit",onClick:w,children:O?(0,m.jsx)(r.A,{}):"Update"}),(0,m.jsx)(n.Button,{size:"sm",variant:"outline",colorScheme:"red",sx:{marginLeft:2,textTransform:"capitalize"},onClick:()=>{e.onClose(!1)},children:"Close"})]})]})]})})}}}]);
//# sourceMappingURL=2107.5d214808.chunk.js.map